import{a as q}from"./chunk-EHGHV7SA.js";import{a as z}from"./chunk-NTFV3UOJ.js";import{f as L,h as P,i as U}from"./chunk-SXKB25RG.js";import{B as G,C as k,D as O,k as N,l as D,n as I,o as a,q as T,r as B,v as A,w as V,x as j,y as M,z as R}from"./chunk-EKOSEFZP.js";import"./chunk-U3QUSVWF.js";import"./chunk-74RUH4UK.js";import{a as H}from"./chunk-37JVPQS2.js";import{f as S,h as w}from"./chunk-BXPCUMYM.js";import{$ as f,Cb as l,Ga as u,Pa as E,Va as y,a as _,b as x,bb as d,e as J,gb as v,ha as C,ia as h,lb as e,mb as i,nb as p,rb as b,sb as s,tb as g}from"./chunk-SEJLVJPR.js";var m=J(H());function K(n,t){n&1&&(e(0,"h1",2),l(1,"MODIFICAR TRABAJADOR"),i())}function Q(n,t){n&1&&(e(0,"h1",2),l(1,"NUEVO TRABAJADOR"),i())}function W(n,t){if(n&1){let o=b();e(0,"p-button",21),s("onClick",function(){C(o);let c=g();return h(c.edit())}),i()}}function X(n,t){if(n&1){let o=b();e(0,"p-button",21),s("onClick",function(){C(o);let c=g();return h(c.save())}),i()}}var F=class n{#o=f(R);#i=f(S);#e=f(w);#t=f(z);editMode=!1;loading=!0;originalData;employeeForm=this.#o.group({cedula:["null",[a.required,a.maxLength(12)]],nombre:["",a.required],contacto:["null",[a.required,a.maxLength(10)]],direccion:["",a.required],fecha_nacimiento:["",a.required],porcentaje_servicio:["null",[a.required]]});ngOnInit(){this.#i.params.subscribe(t=>{if(t&&t.cedula){this.editMode=!0,this.originalData=t;let o=_({},t);o.fecha_nacimiento&&(o.fecha_nacimiento=new Date(o.fecha_nacimiento)),o.porcentaje_servicio&&(o.porcentaje_servicio=parseFloat(o.porcentaje_servicio)),this.employeeForm.patchValue(o)}else this.editMode=!1;this.loading=!1})}onSubmit(){this.employeeForm.valid?console.log(this.employeeForm.value):console.log("Form is invalid")}getFormValue(){return x(_({},this.employeeForm.value),{cedula:this.originalData?.cedula||this.employeeForm.value.cedula})}edit(){if(!this.employeeForm.valid){m.default.fire({title:"Formulario invalido",icon:"error",showConfirmButton:!1,timer:1500});return}this.#t.update(this.getFormValue()).subscribe({next:t=>{m.default.fire({title:"Empleado actualizado",icon:"success",showConfirmButton:!1,timer:1500}),this.#e.navigate(["/employees"])},error:t=>{m.default.fire({title:"Error al actualizar empleado",icon:"error",showConfirmButton:!1,timer:1500})}})}save(){if(!this.employeeForm.valid){m.default.fire({title:"Formulario invalido",icon:"error",showConfirmButton:!1,timer:1500});return}this.#t.save(this.getFormValue()).subscribe({next:t=>{m.default.fire({title:"Empleado guardado",icon:"success",showConfirmButton:!1,timer:1500}),this.#e.navigate(["/employees"])},error:t=>{m.default.fire({title:"Error al guardar empleado",icon:"error",showConfirmButton:!1,timer:1500})}})}cancel(){m.default.fire({title:"\xBFEst\xE1 seguro?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#32cd32",cancelButtonColor:"#d33",confirmButtonText:"Si",cancelButtonText:"No"}).then(t=>{t.isConfirmed&&(m.default.fire({showConfirmButton:!1,title:"Registro cancelado",icon:"success",timer:1500}),this.employeeForm.reset(),this.#e.navigate(["/employees"]))})}limitPercentage(){this.employeeForm.get("porcentaje_servicio")?.value>100&&this.employeeForm.get("porcentaje_servicio")?.setValue(100)}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=E({type:n,selectors:[["employee-form"]],decls:34,vars:6,consts:[[1,"flex","flex-col","justify-center","px-6","py-12","w-screen"],[1,"flex","items-center","justify-center"],[1,"text-white","text-4xl","font-bold","text-center"],[1,"mt-10","sm:mx-auto","sm:w-full","sm:max-w-sm"],[1,"space-y-6",3,"ngSubmit","formGroup"],["variant","in"],["id","cedula","autocomplete","off","formControlName","cedula","maxlength","12",1,"w-full",3,"useGrouping","readonly"],["for","cedula"],["pInputText","","id","nombre","autocomplete","off","formControlName","nombre",1,"w-full"],["for","nombre"],["mode","decimal","inputId","contacto","autocomplete","off","formControlName","contacto","maxlength","10",1,"w-full",3,"useGrouping"],["for","contacto"],["pInputText","","id","direccion","autocomplete","off","formControlName","direccion",1,"w-full"],["for","direccion"],["showIcon","","iconDisplay","input","formControlName","fecha_nacimiento"],["for","fechaNacimiento"],["id","porcentajeServicio","suffix","%","autocomplete","off","formControlName","porcentaje_servicio","max","100","maxlength","3",1,"w-full",3,"onInput"],["for","porcentajeServicio"],[1,"flex","justify-center","gap-4","mt-10"],["severity","success","label","GUARDAR"],["severity","danger","label","CANCELAR",3,"onClick"],["severity","success","label","GUARDAR",3,"onClick"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1),y(2,K,2,0,"h1",2)(3,Q,2,0,"h1",2),i(),e(4,"div",3)(5,"form",4),s("ngSubmit",function(){return r.onSubmit()}),e(6,"p-floatlabel",5),p(7,"p-inputnumber",6),e(8,"label",7),l(9,"C\xE9dula"),i()(),e(10,"p-floatlabel",5),p(11,"input",8),e(12,"label",9),l(13,"Nombre y Apellido"),i()(),e(14,"p-floatlabel",5),p(15,"p-inputnumber",10),e(16,"label",11),l(17,"Contacto"),i()(),e(18,"p-floatlabel",5),p(19,"input",12),e(20,"label",13),l(21,"Direcci\xF3n"),i()(),e(22,"p-floatlabel",5),p(23,"p-datepicker",14),e(24,"label",15),l(25,"Fecha de Nacimiento"),i()(),e(26,"p-floatlabel",5)(27,"p-inputnumber",16),s("onInput",function(){return r.limitPercentage()}),i(),e(28,"label",17),l(29,"Porcentaje de Servicio"),i()(),e(30,"div",18),y(31,W,1,0,"p-button",19)(32,X,1,0,"p-button",19),e(33,"p-button",20),s("onClick",function(){return r.cancel()}),i()()()()()),o&2&&(u(2),v(r.editMode?2:3),u(3),d("formGroup",r.employeeForm),u(2),d("useGrouping",!1)("readonly",r.editMode),u(8),d("useGrouping",!1),u(16),v(r.editMode?31:32))},dependencies:[G,A,I,T,B,M,V,j,q,O,k,L,D,N,U,P],encapsulation:2})};export{F as default};
